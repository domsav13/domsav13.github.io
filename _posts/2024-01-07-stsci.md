---
layout: post
title: Wavelength calibration for Hubble Space Telescope
date: 2024-01-07 11:12:00-0400
description: R&D of a new calibration routine for the Cosmic Origins Spectrograph
tags: 
categories: 
thumbnail: assets/img/cos.jpg
related_posts: false
---

This page is essentially a summary of the [poster](https://aas243-aas.ipostersessions.com/Default.aspx?s=2A-E3-38-C1-E9-54-BF-E7-B6-08-1F-0F-71-07-CC-C1) that I presented in January 2024 at the American Astronomical Society conference. It encompasses the evolution of wavelength calibration for the Cosmic Origins Spectrograph (COS), a spectrograph onboard the Hubble Space Telescope. Any object that absorbs or emits light can be studied with a spectrograph to determine important characteristics such as temperature, density, chemical composition, and velocity. For more, visit [this page](https://science.nasa.gov/mission/hubble/observatory/design/cosmic-origins-spectrograph/) which provides more depth into the instrument and its capabilities. Our work involved developing a new, automated, and more reliable way of calibrating the instrument for best use of wavelength readout as the instrument begins to degrade.

---

### The CalCOS WAVECORR Algorithm

Prior to our work, wavelength calibration ("wavecal") shifts for spectra observed by COS are found using a $$ \chi^2 $$ fitting method that matches an observed spectrum to a template spectrum. This is done by determining the location of the wavecal spectrum on the detector relative to the template, and then applying zero point shifts to align the wavecal and the template. However, this method is not ideal for observing modes in wihch the calibratoin spectra are faint due to sensitivity loss, resulting in shifts that are reported as unreliable by the calibration pipeline; shifts that are found must exceed an arbitrary cutoff threshold or they will be reported as unreliable. Therefore, there is a need to develop a more versatile method of finding these calibration shifts for both the near- and far-ultraviolet detectors (NUV/FUV).

<div class="row mt-3">
    <div class="col-md-5">
        {% include figure.liquid loading="eager" path="assets/img/g225.jpg" class="img-fluid rounded z-depth-1" %}
    </div>
</div>
<div class="caption">
    Declining sensitivity in the COS NUV G225M grating. A similar trend is seen for G285M whereas the G185M and G230L gratings are not decreasing. This reduction in sensitivity results in lower signal-to-noise wavecal observations, which can cause CalCOS to return unreliable wavecal shifts. 
</div>

---

### The New Cross-Correlation Method

In CalCOS, a quadratic fit is performed on the $$ \chi^2 $$ curve and the location of the minimum is returned as the shift. In the new method, the shift that is returned is the location of the global maximum of the cross-correlation signal between the two spectra relative to one another. SciPy functions [signal.correlate](https://docs.scipy.org/doc/scipy-1.16.2/reference/generated/scipy.signal.correlate.html) and [signal.correlation_lags](https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.correlation_lags.html) use the two spectra as parameters to generate the cross-correlation function. Then, [optimize.curve_fit](https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html) is used to fit a gaussian to the peak of the cross-correlation function so that the mean "X-Corr Shift" and uncertainty on the mean $$ \sigma_{peak} $$ are recorded with precision. After testing archival observations, the means and standard deviations of residuals imply that the cross-correlation is as successful as the current shift-finding method for FUV observations. 

<div class="row mt-3">
    <div class="col-md-5">
        {% include figure.liquid loading="eager" path="assets/img/wavecal-comparison.jpg" class="img-fluid rounded z-depth-1" %}
    </div>
    <div class="col-md-5">
        {% include figure.liquid loading="eager" path="assets/img/residual-plots.jpg" class="img-fluid rounded z-depth-1" %}
    </div>
</div>
<div class="caption">
    Left: an observed spectrum (blue) compared to a template (orange); the shift between the two is our measured quantity. Right: residual plots of wavecal shifts returned by each method for FUVA and FUVB, with means and standard deviations.
</div>

---

### Improving NUV Wavecal Shifts

As shown in the first figure, there is a significant need for a more reliable algorithm due to time dependent sensitivity in some COS NUV observing modes, especially for the G225M and G285M gratings. 

Because of this decline in sensitivity, the existing algorithm can return large $$ \chi^2 $$ values when measuring the wavecal shift, some of which are labeled as "not found" (SPEC_FOUND=False). As sensitivity continues to decrease, an increasing number of spectra may be incorrectly labeled as "not found" in false negative situations. Because the distribution of wavecal shifts for spectra where SPEC_FOUND=False is similar to those in which SPEC_FOUND=True, a large number of these shifts may be correct despite being labeled as "not found." 
