---
layout: post
title: System identification of a DC motor
date: 2025-09-10 11:12:00-0400
description: White- and black-box approaches to motor control
tags: 
categories: 
thumbnail: assets/img/sys-id.jpg
related_posts: false
---

This project investigates system identification of a DC motor simulator using both analytical and data-driven methods. A white-box state-space model was first derived to establish the expected dynamics, step and frequency responses were measured, and then black-box methods were trained on the data to model the full electromechanical system.

---

### White Box Approach

An electric DC motor is connected to a wheel with linear damping $$ c $$ and inertia $$ J $$. The motor generates a torque $$ \tau $$ with some angular velocity $$ \omega $$ which is related to the back emf $$ v_{emf} $$ by the motor constant $$ K_v $$. The motor converts electrical power to mechanical power with efficiency $$ \eta $$, with the equations:

$$
\begin{aligned}
\omega = K_v v_{emf} \quad\quad\quad \eta = \frac{P_{out}}{P_{in}}
\end{aligned}
$$

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/img/wing.jpg" class="img-fluid rounded z-depth-1" %}
    </div>
</div>
<div class="caption">
    A DC motor connected to a wheel, the overarching schematic for this system identification analysis.
</div>

Using the efficiency equation with mechanical and electrical power, the relation between current $$ i_m $$ and torque $$ \tau $$ is given by:

$$
\begin{aligned}
P_{out}&=\etaP_{in}\\
\tau \omega &= \eta i_m v_{emf}\\
\tau K_v v_{emf} &= \eta i_m v_{emf}\\
\frac{K_v}{\eta} \tau &= i_m
\end{aligned}
$$

Applying Newton's law of rotation to the system, the mechanical equation of motion is $$ J \dot{\omega} = \tau - c \omega $$.

Applying Kirchoff's current and voltage laws with the current $$ i_m $$, the electrical equation of motion is $$ v_{in} = v_{emf} + R_m i_m $$.

Combining both equations of motion with the given relations:

$$
\begin{aligned}
J\dot{\omega}&=\frac{\eta}{K_v}i_m-c\omega\\
J\dot{\omega}&=\frac{\eta}{R_mK_v}(v-v_{emf})-c\omega\\
J\dot{\omega}&=\frac{\eta}{R_mK_v}(v_{in}-\frac{\omega}{K_v})-c\omega\\
J\dot{\omega}&=\frac{\eta}{R_mK_v}v_in-(c+\frac{\eta}{R_mK_v^2})\omega
\end{aligned}
$$

In state-space form, the system is represented by:

$$
\dot{x}=\begin{bmatrix}\dot{\omega}\\\dot{\theta}\end{bmatrix}=\begin{bmatrix}\frac{-\eta}{JR_mK_v^2}-\frac{c}{J}&0\\1&0\end{bmatrix}\begin{bmatrix}\omega\\\theta\end{bmatrix}+\begin{bmatrix}\frac{\eta}{JR_mK_v}\\0\end{bmatrix}v_{in}=Ax+Bu
$$

Using these matrices, the analytical solution $$ x(t) $$ given an input $$ u(t) $$ is formulated as:

$$
x(t)=e^{At}x_0+\int_0^t e^{A(t-\tau)}Bu(\tau)d\tau
$$

For the next analyses, parameters are chosen. The resistance of the motor coil is $$ R_m = 2 \ohm $$, the moment of inertia of the wheel is $$ J = 0.004 kgm^2 $$, the linear damping coefficient of the wheel is $$ c = 0.015 \frac{Ns}{mrad} $$, the motor constant is $$ K_v = 100 \frac{rad}{sV} $$, and the efficiency is $$ \eta = 0.9 $$. 

With the chosen parameters, the analytical solution $$ x(t) $$ is illustrated for a unit step input ($$ u(\tau)=v_{in}(t)=1 $$) and five randomized initial conditions near zero, showing how each state $$ \omega(t) $$ and $$ \theta(t) $$ respond to such an input. 

img

Finally, the poles of the system are analyzed, which dictate the stability and how a response may oscillate and settle over time. THe poles are the eigenvalues of the state matrix A:

$$
A=\begin{bmatrix}\frac{-\eta}{JR_mK_v^2}-\frac{c}{J}&0\\1&0\end{bmatrix}=\begin{bmatrix}-3.7388&0\\1&0\end{bmatrix}
$$

The characteristic equation is $$ \Delta(s) = s(s+3.7388) $$ thus the system has 2 poles, one at 0 and one at -3.7388. 

---

### Step Response
