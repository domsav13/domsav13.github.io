<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Wavelength calibration for Hubble Space Telescope | Dominic Savarino </title> <meta name="author" content="Dominic Savarino"> <meta name="description" content="R&amp;D of a new calibration routine for the Cosmic Origins Spectrograph"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://domsav13.github.io/blog/2024/stsci/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Dominic</span> Savarino </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Wavelength calibration for Hubble Space Telescope</h1> <p class="post-meta"> Created on January 07, 2024 </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>This page is essentially a summary of the <a href="https://aas243-aas.ipostersessions.com/Default.aspx?s=2A-E3-38-C1-E9-54-BF-E7-B6-08-1F-0F-71-07-CC-C1" rel="external nofollow noopener" target="_blank">poster</a> that I presented in January 2024 at the American Astronomical Society conference. It encompasses the evolution of wavelength calibration for the Cosmic Origins Spectrograph (COS), a spectrograph onboard the Hubble Space Telescope. Any object that absorbs or emits light can be studied with a spectrograph to determine important characteristics such as temperature, density, chemical composition, and velocity. Visit <a href="https://science.nasa.gov/mission/hubble/observatory/design/cosmic-origins-spectrograph/" rel="external nofollow noopener" target="_blank">this page</a> which provides more depth into the instrument and its capabilities. Our work involved developing a new, automated, and more reliable way of calibrating the instrument for best use of wavelength readout as the instrument begins to degrade.</p> <hr> <h3 id="the-calcos-wavecorr-algorithm">The CalCOS WAVECORR Algorithm</h3> <p>Prior to our work, wavelength calibration (“wavecal”) shifts for spectra observed by COS are found using a \(\chi^2\) fitting method that matches an observed spectrum to a template spectrum. This is done by determining the location of the wavecal spectrum on the detector relative to the template, and then applying zero point shifts to align the wavecal and the template. However, this method is not ideal for observing modes in which the calibration spectra are faint due to sensitivity loss, resulting in shifts that are reported as unreliable by the calibration pipeline; shifts that are found must exceed an arbitrary cutoff threshold or they will be reported as unreliable. Therefore, there is a need to develop a more versatile method of finding these calibration shifts for both the near- and far-ultraviolet detectors (NUV/FUV).</p> <div class="row mt-3"> <div class="col-12 col-md-7 mx-auto mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/g225-480.webp 480w,/assets/img/g225-800.webp 800w,/assets/img/g225-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/g225.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Declining sensitivity in the COS NUV G225M grating. A similar trend is seen for G285M whereas the G185M and G230L gratings are not decreasing. This reduction in sensitivity results in lower signal-to-noise wavecal observations, which can cause CalCOS to return unreliable wavecal shifts. </div> <hr> <h3 id="the-new-cross-correlation-method">The New Cross-Correlation Method</h3> <p>In CalCOS, a quadratic fit is performed on the \(\chi^2\) curve and the location of the minimum is returned as the shift. In the new method, the shift that is returned is the location of the global maximum of the cross-correlation signal between the two spectra relative to one another. SciPy functions <a href="https://docs.scipy.org/doc/scipy-1.16.2/reference/generated/scipy.signal.correlate.html" rel="external nofollow noopener" target="_blank">signal.correlate</a> and <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.correlation_lags.html" rel="external nofollow noopener" target="_blank">signal.correlation_lags</a> use the two spectra as parameters to generate the cross-correlation function. Then, <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html" rel="external nofollow noopener" target="_blank">optimize.curve_fit</a> is used to fit a gaussian to the peak of the cross-correlation function so that the mean “X-Corr Shift” and uncertainty on the mean \(\sigma_{peak}\) are recorded. After testing archival observations, the means and standard deviations of residuals imply that the cross-correlation is as successful as the current shift-finding method for FUV observations.</p> <div class="row mt-3"> <div class="col-12"> <div class="row justify-content-center align-items-center"> <div class="col-12 col-md-6"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/wavecal-comparison-480.webp 480w,/assets/img/wavecal-comparison-800.webp 800w,/assets/img/wavecal-comparison-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/wavecal-comparison.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-12 col-md-6"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/residual-plots-480.webp 480w,/assets/img/residual-plots-800.webp 800w,/assets/img/residual-plots-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/residual-plots.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> </div> </div> <div class="caption"> Left: an observed spectrum (blue) compared to a template (orange); the shift between the two is our measured quantity. Right: residual plots of wavecal shifts returned by each method for FUVA and FUVB, with means and standard deviations. </div> <hr> <h3 id="improving-nuv-wavecal-shifts">Improving NUV Wavecal Shifts</h3> <p>As shown in the first figure, there is a significant need for a more reliable algorithm due to time dependent sensitivity in some COS NUV observing modes, especially for the G225M and G285M gratings.</p> <p>Because of this decline in sensitivity, the existing algorithm can return large \(\chi^2\) values when measuring the wavecal shift, some of which are labeled as “not found” (SPEC_FOUND=False). As sensitivity continues to decrease, an increasing number of spectra may be incorrectly labeled as “not found” in false negative situations. Because the distribution of wavecal shifts for spectra where SPEC_FOUND=False is similar to those in which SPEC_FOUND=True, a large number of these shifts may be correct despite being labeled as “not found.” The new algorithm was performed on a sample of G225M and G285M observations, known to contain wavecal shifts that were likely incorrectly labeled as “not found” by the existing algorithm. The relatively small residuals of CalCOS and X-Corr shifts suggest that in situations where CalCOS shifts are deemed unreliable, they are actually correct. Further, the new method is able to reliably produce a shift between the wavecal and template spectra despite the current barriers due to sensitivity loss.</p> <div class="row mt-3"> <div class="col-12"> <div class="row justify-content-center"> <div class="col-12 col-md-6"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/nuv-left-480.webp 480w,/assets/img/nuv-left-800.webp 800w,/assets/img/nuv-left-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/nuv-left.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-12 col-md-6"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/nuv-right-480.webp 480w,/assets/img/nuv-right-800.webp 800w,/assets/img/nuv-right-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/nuv-right.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> </div> </div> <div class="caption"> Left: histograms of NUV gratings in which the CalCOS shift was determined to be "not found" (SPEC_FOUND=False). Right: differences between the CalCOS and X-Corr wavecal shifts; the small residuals for the SPEC_FOUND=False observations suggest that CalCOS is incorrectly labeling these shifts as unreliable, and that the X-Corr method is still able to correctly measure the shift. </div> <p>Ideally, like the existing method, we would be able to determine whether or not the shift returned by the cross-correlation is reliable. One potential criterion for determining reliable shifts is the uncertainty in the position of the cross-correlation peak computed as the square root of the diagonals of the covariance matrix returned by scipy.optimize.curve_fit. We can plot the distribution of these uncertainties and separate them based on whether or not the X-Corr shifts are greater than 1 pixel away from the existing CalCOS shifts. For comparison, we also show the X-Corr shift uncertainties for all shifts that were determined to be “not found” by the existing pipeline. Presumably, some of these shifts are actually bad shifts. But if we assume that any wavecal exposure that has a large difference (&gt;1 pixel) in shifts between the two methods is truly unmeasurable, then X-Corr shifts with large reported uncertainties can be flagged as unreliable.</p> <div class="row mt-3"> <div class="col-12 col-md-7 mx-auto mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/nuv-uncertainties-480.webp 480w,/assets/img/nuv-uncertainties-800.webp 800w,/assets/img/nuv-uncertainties-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/nuv-uncertainties.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Histograms of the uncertainties of the cross-correlation peak locations shown separately for X-Corr shifts that are within 1 pixel of the CalCOS shifts (blue) and X-corr shifts that are &gt;1 pixel from the CalCOS shifts (orange). If we assume the high residual histogram represents wavecal shifts that are truly unmeasurable, then we may be able to use X-Corr shift uncertainty to distinguish between reliable and unreliable shifts. </div> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Dominic Savarino. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?5250cef8c2fb79f962a070f63311fbfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>