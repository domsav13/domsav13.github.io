<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> System identification of a DC motor | Dominic Savarino </title> <meta name="author" content="Dominic Savarino"> <meta name="description" content="White- and black-box approaches to motor control"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://domsav13.github.io/blog/2025/sys-id/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Dominic</span> Savarino </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">System identification of a DC motor</h1> <p class="post-meta"> Created on September 10, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>This project investigates system identification of a DC motor simulator using both analytical and data-driven methods. A white-box state-space model was first derived to establish the expected dynamics, step and frequency responses were measured, and then black-box methods were trained on the data to model and predict the behavior of the full electromechanical system.</p> <hr> <h3 id="white-box-approach">White Box Approach</h3> <p>An electric DC motor is connected to a wheel with linear damping \(c\) and inertia \(J\). The motor generates a torque \(\tau\) with some angular velocity \(\omega\) which is related to the back emf \(v_{emf}\) by the motor constant \(K_v\). The motor converts electrical power to mechanical power with efficiency \(\eta\), with the equations:</p> \[\begin{aligned} \omega = K_v v_{emf} \quad\quad\quad \eta = \frac{P_{out}}{P_{in}} \end{aligned}\] <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/wing-480.webp 480w,/assets/img/wing-800.webp 800w,/assets/img/wing-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/wing.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> A DC motor connected to a wheel, the overarching schematic for this system identification analysis. </div> <p>Using the efficiency equation with mechanical and electrical power, the relation between current \(i_m\) and torque \(\tau\) is given by:</p> \[\begin{aligned} P_{out}&amp;=\eta P_{in}\\ \tau \omega &amp;= \eta i_m v_{emf}\\ \tau K_v v_{emf} &amp;= \eta i_m v_{emf}\\ \frac{K_v}{\eta} \tau &amp;= i_m \end{aligned}\] <p>Applying Newton’s law of rotation to the system, the mechanical equation of motion is \(J \dot{\omega} = \tau - c \omega\).</p> <p>Applying Kirchoff’s current and voltage laws with the current \(i_m\), the electrical equation of motion is \(v_{in} = v_{emf} + R_m i_m\).</p> <p>Combining both equations of motion with the given relations:</p> \[\begin{aligned} J\dot{\omega}&amp;=\frac{\eta}{K_v}i_m-c\omega\\ J\dot{\omega}&amp;=\frac{\eta}{R_mK_v}(v-v_{emf})-c\omega\\ J\dot{\omega}&amp;=\frac{\eta}{R_mK_v}(v_{in}-\frac{\omega}{K_v})-c\omega\\ J\dot{\omega}&amp;=\frac{\eta}{R_mK_v}v_{in}-(c+\frac{\eta}{R_mK_v^2})\omega \end{aligned}\] <p>In state-space form, the system is represented by:</p> \[\dot{x}=\begin{bmatrix}\dot{\omega}\\\dot{\theta}\end{bmatrix}=\begin{bmatrix}\frac{-\eta}{JR_mK_v^2}-\frac{c}{J}&amp;0\\1&amp;0\end{bmatrix}\begin{bmatrix}\omega\\\theta\end{bmatrix}+\begin{bmatrix}\frac{\eta}{JR_mK_v}\\0\end{bmatrix}v_{in}=Ax+Bu\] <p>Using these matrices, the analytical solution \(x(t)\) given an input \(u(t)\) is formulated as:</p> \[x(t)=e^{At}x_0+\int_0^t e^{A(t-\tau)}Bu(\tau)d\tau\] <p>For the next analyses, parameters are chosen. The resistance of the motor coil is \(R_m = 2 \Omega\), the moment of inertia of the wheel is \(J = 0.004 kgm^2\), the linear damping coefficient of the wheel is \(c = 0.015 \frac{Ns}{mrad}\), the motor constant is \(K_v = 100 \frac{rad}{sV}\), and the efficiency is \(\eta = 0.9\).</p> <p>With the chosen parameters, the analytical solution \(x(t)\) is illustrated for a unit step input (\(u(\tau)=v_{in}(t)=1\)) and five randomized initial conditions near zero, showing how each state \(\omega(t)\) and \(\theta(t)\) respond to such an input.</p> <p>img</p> <p>Finally, the poles of the system are analyzed, which dictate the stability and how a response may oscillate and settle over time. THe poles are the eigenvalues of the state matrix A:</p> \[A=\begin{bmatrix}\frac{-\eta}{JR_mK_v^2}-\frac{c}{J}&amp;0\\1&amp;0\end{bmatrix}=\begin{bmatrix}-3.7388&amp;0\\1&amp;0\end{bmatrix}\] <p>The characteristic equation is \(\Delta(s) = s(s+3.7388)\) thus the system has 2 poles, one at 0 and one at -3.7388.</p> <hr> <h3 id="step-response">Step Response</h3> <p>In this section, motor velocity \(\omega(t)\) step responses from the motor plant simulator will be normalized and singular value decomposition (SVD) will be used to estimate the nonzero pole \(a\). The first order dynamics of the system can be modeled by a pole at \(a\) and a DC gain \(K_{DC}\), which is estimated from the final value of a response once the system has settled to a stable state. With zero initial conditions, these dynamics can be expressed as</p> \[\dot{x}=ax+\frac{K_{DC}}{a}v_{in}\] <p>the \(k\) step response to which is \(x(t) = kK_{DC}(1-e^{at})\). With simulated data allowing nonzero initial conditions, however, the first-order step response becomes \(x(t) = kK_{DC}+(x_0-kK_{DC})e^{at}\). The normalization is thus:</p> \[\hat{x}(t)=1-\frac{x(t)-x_0}{kK_{DC}-x_0}=e^{at}\] <p>This normalization allows for the estimation of \(a\) through the SVD least squares fit of \(\ln \hat{x}(t) = at\).</p> <p>For 50 velocity simulations, the normalized responses are shown. Initial conditions for \(\omega(0)\) were randomized in [-6,6] rad/s and \(\theta(0)\) in [-0.5,0.5] rad. The step magnitude \(k\) was randomly chosen in [1,12] V. The DC gain \(K_{DC}\) was estimated using the final 10 percent of each response.</p> <p>img</p> <p>These simulations returned an average pole of \(m_a = -3.50\) with standard deviation \(\sigma_a=1.00\) using a fine mesh of \(\Delta t = 0.001\) over a 3 second total time. With the noise and nonlinearities included in the simulator, the pole falls within the expected range of values predicted by the white box approach. Using a more coarse time interval leads to high-variance least squares results, most likely due to the noise present.</p> <hr> <h3 id="frequency-response">Frequency Response</h3> <p>In this section, a sinusoidal input is used to determine the frequency response of the system. An input \(u(t) = A\sin(\omega t)\) results in a response of the form \(x(t) = GA\sin(\omega t + \phi)\) with a gain \(G\) and phase shift \(\phi\) which are found using a gradient descent method. Gradient descent methods update the desired parameters by means of predefined loss functions, which are used here to fit sine waves to the motor plant output at different frequencies, and to fit the first order Bode plot. To mirror data sampled from the step response simulations, the sinusoidal input is forced to be positive in the range [0,12] V using \(u(t) = V_{bias} + A\sin(\omega t)\) where \(V_{bias} = 6\) and \(A \in (0,6]\).</p> <p>To fit the sinusoidal response, the motor plant output is assumed to take the form \(y(t) \approx a\sin(\omega t) + b\cos(\omega t)\) and the model is initialized as \(\hat{y}(t) = a\sin(\omega t) + b\cos(\omega t)\). The residual error is \(e(t) = \hat{y}(t)-y(t)\). The mean squared error loss function is then defined as:</p> \[J(a,b) = \frac{1}{N} \sum_{i=1}^N [e(t_i)^2]^2 = \frac{1}{N} \sum_{i=1}^N [a\sin(\omega t_i) + b\cos(\omega t_i) - y(t_i)]^2\] <p>with updates \(a \leftarrow a - lr \frac{\partial{J}}{\partial{a}}\) and \(b \leftarrow b -lr\frac{\partial{J}}{\partial{b}}\) where \(lr\) is the learning rate.</p> <p>These updates allow for the amplitude, gain, and phase to be computed as \(A = \sqrt{a^2+b^2}\), \(G = 20\log_{10}(A)\), and \(\phi = \tan^{-1}\left(\frac{b}{a}\right)\) respectively. A similar approach is used to fit the Bode plots from the simulated data. The transfer function for a first order Bode plot assumes the model \(G(s) = \frac{K}{1+s\tau}\). Additionally, the following equations are used to simplify the gain magnitude \(M(\omega)\) and phase \(\phi(\omega)\) in terms of the relevant parameters \(K\) and \(\tau\):</p> \[M(\omega)=20\log_{10}|G(i\omega)|=20\log_{10}K-10\log_{10}(1+\omega^2\tau^2) \quad\quad\quad \phi(\omega)=\angle G(i\omega)=-\tan^{-1} (\omega \tau) \frac{180}{\pi}\] <p>The desired parameters \(\theta\), in the logarithmic space, are thus the DC gain and the time constant: \(\theta = \begin{bmatrix}\log K&amp;\log\tau\end{bmatrix}^T\). The magnitude and phase errors are defined as \(e_m(\omega)=M_{model}(\omega)-M_{data}(\omega)\) and \(e_p(\omega) = \phi_{model}(\omega)-\phi_{data}(\omega)\) respectively. The loss function is defined as:</p> \[J(\theta)=\sum_{i=1}^N [e_m(\omega_i)^2+e_p(\omega_i)^2]\] <p>with the vector update \(\theta \leftarrow \theta - lr \nabla_{\theta}J. Learning rates are adjusted each sweep. The gradient descent methods estimated the DC gain\) K = 1.5 \(, time constant\) \tau = 0.248 \(s, and thus a pole located at frequency\) p = -4.04 $$ rad/s.</p> <p>img</p> <hr> <h3 id="black-box-approaches">Black Box Approaches</h3> <p>The following sections involve using black-box techniques to generate predictive models of the motor plant simulator.</p> <h4 id="radial-basis-function-network">Radial Basis Function Network</h4> <p>The purpose of the radial basis function network (RBFN) is to approximate the discretized function that represents the electromechanical system:</p> \[x_{k+1}=f(x_k,u_k)\] <p>To train the RBFN, data from the step and frequency response simulations are loaded into \((x_i,y_i)\) pairs where \(x_i = \begin{bmatrix}x_k&amp;u_k\end{bmatrix}^T\) and \(y_i=x_{k+1}\) for each trajectory. The goal is to biuld the radial basis function matrix for a batch</p> \[\Phi(X)_{n,i}=\phi(x_n)=\exp(-\epsilon_i ||z_n-c_i||^2)\] <table> <tbody> <tr> <td>where centers \(c_i\) are chosen by k-means (for several candidate number of centers \(k\)). Each data point is assigned to the nearest center, creating clusters where each center is recomputed as the mean of the points in its cluster. This is done iteratively until the shift of centers is below a certain tolerance. \(\epsilon_i\) is found by taking the largest eigenvalue of the covariance matrix of the cluster \(C_i\). Once the radial basis function matrix is built, SVD is used to find the weights \(W\) that minimize $$</td> <td> </td> <td>\Phi W - Y_{tr}</td> <td> </td> <td>\(where\) Y_{tr} \(are the targets (next states). The process is repeated for each\) k $$ until the one with the lowest root means squared error is selected for the final fit. The model’s capabilities can be visually inspected below, which shows the scope of the training data that was used.</td> </tr> </tbody> </table> <p>img</p> <h4 id="multi-layered-perceptron">Multi-Layered Perceptron</h4> <p>As a feedforward neural network, the multi-layered perceptron (MLP) approach consists of a similar architecture to that of a RBFN, except it typically has much more hidden layers where weighted inputs are passed through nonlinear activation functions. The goal remains the same, to learn a discretized state update model</p> \[x_{k+1}=f(x_k,u_k)\] <p>where \(f\) is a nonlinear mapping approximated by an MLP which is initilized here using the Tensorflow Python library. Training is done in mini-batches with the Adam optimizer and mean squared error as the loss function. Similar to RBFN training, the architecture with the lowest root means squared error is selected and saved as the final fit.</p> <p>As noted in the training coverage, data regarding step responses form horizontal bands across randomly generated initial conditions. However, most of the training data is dominated by frequency response data which covers the full range of input but only a limited amount of initial conditions. The density of the scatter plot implies strong black-box performance for positive initial conditions. By experimenting with different inputs and initial conditions, the strengths and shortcomings of the training data and RBFN/MLP methods are revealed.</p> <p>2 imgs good 2 imgs bad</p> <p>To improve these models, it is obvious that a wider range of initial conditions must be simulated and sampled. However, under certain conditions, the black-box methods are capable of low-bias approximations of both step and frequency responses.</p> <h4 id="black-box-conclusions">Black Box Conclusions</h4> <p>Nonlinear systems often respond differently to small versus large inputs. Larger inputs lead to faster rise times and higher steady-state velocities, as expected from motor physics. Both the MLP and RBFN capture the general trend of higher step magnitudes, but at a certain point extrapolation becomes necessary due to the limitations of the training set.</p> <p>2 plots step</p> <p>Regarding these two approaches, the RBFN is generally good for interpolation and weaker for extrapolation due to it being a local fit sensitive to training data density. The MLP, however, can generalize better but may smooth way details (such as the noise and nonlinearities included in the simulator). In terms of implementation, the RBFN training has proven to be way easier and practical as k-means and SVD are deterministic and require little to no tuning. On the other hand, the MLP requires the tuning of several hyperparameters (epochs, hidden layers, iterations, etc.) and may perform better as a global function approximator through iterative design. The RBFN performs well for scenarios that fall inside the training coverage whereas the MLP is expected to be more generalizable for unseen states or inputs.</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Dominic Savarino. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?5250cef8c2fb79f962a070f63311fbfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>