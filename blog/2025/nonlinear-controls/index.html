<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Nonlinear control of a DC motor | Dominic Savarino </title> <meta name="author" content="Dominic Savarino"> <meta name="description" content="Control system design using Lyapunov stability and sliding manifolds"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://domsav13.github.io/blog/2025/nonlinear-controls/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Dominic</span> Savarino </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Nonlinear control of a DC motor</h1> <p class="post-meta"> Created on November 25, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h3 id="setup">Setup</h3> <p>The topic of study is the implementation of nonlinear control frameworks on the motor wheel system below. The true system dynamics are modeled separately as a Python simulator including several nonlinear effects such as stribeck friction, aerodynamic resistance, and more.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/motor-480.webp 480w,/assets/img/motor-800.webp 800w,/assets/img/motor-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/motor.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> A DC motor connected to a wheel, the electromechanical system for this analysis. </div> <p>A linear system can be formed for this system, but it is better represented with nonlinear, affine assumptions:</p> \[\dot{\omega}=f(\omega)+g(\omega)v_{in}\] <p>Two commonly used nonlinear methods include adaptive control and sliding mode control, which will be explored in further detail in the following sections. Adapative control makes the controller learn the dynamics in real time while maintaining stability whereas sliding mode control forces the states of a system to reach a predetermined sliding surface where the dynamics are designed to be stable and insensitive to disturbances.</p> <hr> <h3 id="model-reference-adaptive-control">Model Reference Adaptive Control</h3> <p>Model reference adaptive control (MRAC) is an architecture in which a reference model representing ideal closed-loop behavior is chosen and the controller adjusts its own parameters in real time to force the plant to follow the reference. The following reference model will be used:</p> \[\dot{\omega}_m=-10\omega_m+10r\] <hr> <h4 id="linear-mrac">Linear MRAC</h4> <p>There are two methods for performing MRAC: direct and indirect. In both cases, the controller must be designed to follow the reference model with the given linear dynamics that approximate the system:</p> \[\dot{\omega}=a \omega + bv_{in}\] <p>To achieve an equivalence for the reference model, the controller $$ v_{in}^* = \frac{1}{b}\left(-(a+a_m)\omega+b_mr\right) is used:</p> \[\begin{aligned} \dot{\omega}&amp;=a \omega+bv_{in}^*\\ &amp;= a\omega + b\left(\frac{1}{b}(-(a+a_m)\omega+b_mr)\right) &amp;= -a_m\omega+b_mr \end{aligned}\] <p>where \(a_m=b_m=10\) are chosen to match the previously established reference model \(\dot{\omega}_m\).</p> <hr> <h5 id="direct-mrac">Direct MRAC</h5> <p>In direct MRAC, the controller gains are directly adapted with weights \(\hat{\alpha}\) and \(\hat{\beta}\) for \(v_{in} = -\hat{\alpha}\omega+\hat{\beta}r\). The dynamics become:</p> \[\begin{aligned} \dot{\omega}&amp;=a\omega+bv_{in}\\ &amp;= (a-b\hat{\alpha})\omega+b\hat{\beta}r\\ \dot{\omega}_m&amp;=-a_m\omega_m + b_mr \end{aligned}\] <p>where the unknown, ideal gains \((\alpha, \beta)\) match the model: \(a - b\alpha = -_am\) and \(b\beta=b_m\). With the error terms \(\bar{\alpha}=\hat{\alpha}-\alpha\) and \(\bar{\beta}=\hat{\beta}-\beta\), the dynamics are expanded further to:</p> \[\begin{aligned} \dot{\omega}&amp;=a\omega+b(-\hat{\alpha}\omega+\hat{\beta}r)\\ &amp;= a\omega -b\omega(\bar{\alpha}+\alpha)+br(\bar{\beta}+\beta)\\ &amp;= (a-b\bar{\alpha}-b\alpha)\omega+(b\bar{\beta}+b\beta)r\\ &amp;= (-a_m-b\bar{\alpha})\omega+(b\bar{\beta}+b_m)r \end{aligned}\] <table> <tbody> <tr> <td>The Lyapunov function $$ V(e,\bar{\alpha},\bar{\beta}) = \frac{1}{2}e^2+\frac{</td> <td>b</td> <td>}{2\gamma_1}\bar{\alpha}^2+\frac{</td> <td>b</td> <td>}{2\gamma_2}\bar{\beta}^2 \((where\) \gamma_1 \(and\) \gamma_2 \(are positive real values) is used with the adaptation laws\) \dot{\hat{\alpha}}=\gamma_1 sign(b) \omega e \(and\) \dot{\hat{\beta}} = -\gamma_2 sign(b) r e \(to guarantee negative definiteness in the tracking error, which ensures stability of the MRAC closed-loop system. Before showing that\) \dot{V} \le 0 \(with this setup, the time derivative of the error term\) e = \omega - \omega_m $$ is needed:</td> </tr> </tbody> </table> \[\begin{aligned} \dot{e}&amp;=\dot{\omega}-\dot{\omega}_m\\ &amp;= (-a_m-b\bar{\alpha})\omega+(b\bar{\beta}+b_m)r-(-a_m\omega_m+b_mr)\\ &amp;= -a_m(\omega-\omega_m)-b\bar{\alpha}\omega+b\bar{\beta}r\\ &amp;= -a_me-b\bar{\alpha}\omega+b\bar{\beta}r \end{aligned}\] <p>Using the aforementioned Lyapunov function, its derivative (proving negative definiteness) is:</p> \[\begin{aligned} \dot{V}(e,\bar{\alpha},\bar{\beta})&amp;=e\dot{e}+|b|sign(b)\omega e \bar{\alpha} - |b|sign(b)r e \bar{\beta}\\ &amp;= e(-a_me-b\bar{\alpha}\omega+b\bar{\beta}r)+b\omegae\bar{\alpha}-bre\bar{\beta}\\ &amp;= -a_me^2 \end{aligned}\] <hr> <h5 id="indirect-mrac">Indirect MRAC</h5> <p>In indirect MRAC, the parameters of the plant model are estimated and used to calculate the gains for the control law. With estimates \(\hat{a}\) and \(\hat{b}\) for ideal gains \(a\) and \(b\), the control law is established as:</p> \[v_{in}=\frac{1}{\hat{b}}\left(-(a_m+\hat{a})\omega+b_mr\right)\] <p>With the error terms \(\bar{a} = \hat{a} - a\) and \(\bar{b}=\hat{b}-b\), the dynamics are expanded to:</p> \[\begin{aligned} \dot{\omega}&amp;=a\omega+bv_{in}\\ &amp;= a\omega + \frac{b}{\hat{b}\left(-(a_m+\hat{a})\omega+b_mr\right)\\ &amp;= a\omega + (1-\frac{\bar{b}}{\hat{b}}\left(-(a_m+\hat{a})\omega+b_mr\right)\\ &amp;= a\omega-(a_m+\hat{a})\omega+b_mr+\frac{\bar{b}}{\hat{b}}(a_m+\hat{a})\omega-\frac{\bar{b}}{\hat{b}}b_mr\\ &amp;= -(a_m+\bar{a})\omega+b_mr+\frac{\bar{b}{\hat{b}}\left((a_m+\hat{a})\omega-b_mr\right) \end{aligned}\] <p>With the adaptation laws \(\dot{\hat{a}} = \gamma_1\omegae\) and \(\dot{\hat{b}} = \gamma_2v_{in}e\) the time derivative of the Lyapunov function \(v(e,\bar{a},\bar{b}) = \frac{1}{2}e^2 + \frac{1}{2\gamma_1}\bar{a}^2+\frac{1}{2\gamma_2}\bar{b}^2\) will be negative definite, where \(\gamma_1\) and \(\gamma_2\) are positive real values. To show this, the time derivative of the error term \(e = \omega - \omega_m\) is needed again:</p> \[\begin{aligned} \dot{e}&amp;=\dot{\omega}-\dot{\omega}_m\\ &amp;= -a_m(\omega-\omega_m)-\bar{a}\omega+\frac{\bar{b}}{\hat{b}}\left((a_m+\hat{a})\omega-b_mr\right)\\ &amp;= -a_me-\bar{a}\omega+\frac{\bar{b}}{\hat{b}}\left((a_m+\hat{a})\omega-b_mr\right) \end{aligned}\] <p>Then, the derivative of the Lyapunov function (proving negative definiteness) is:</p> <p>$$ \begin{aligned} \dot{v}(e,\bar{a},\bar{b})&amp;=e\dot{e}+\frac{1}{\gamma_1}\bar{a}\dot{\bar{a}}+\frac{1}{\gamma_2}\bar{b}\dot{\bar{b}}<br> &amp;= e\left(-a_me-\bar{a}\omega+\frac{\bar{b}}{\hat{b}}\left((a_m+\hat{a})\omega-b_mr\right)+\bar{a}\omegae+\bar{b}ev_{in}<br> &amp;= -a_me^2+\frac{\bar{b}}{\hat{b}}e\left((a_m+\hat{a})\omega-b_mr\right)+\bar{b}e\frac{1}{\hat{b}}\left(-(a_m+\hat{a})\omega+b_mr\right)<br> &amp;= -a_me^2</p> <hr> <h4 id="comparison">Comparison</h4> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> Â© Copyright 2026 Dominic Savarino. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?5250cef8c2fb79f962a070f63311fbfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>